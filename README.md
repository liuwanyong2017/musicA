# musicAPI
# 基于百度音乐的免费资源库做的音乐网站
# 注意！有时候，百度方可能会限制每天访问请求，所以会报错，等待一会，再刷新！由于是https协议的页面，浏览器会默认阻止脚本的运行，打开页面会报错，这时候点击页面的搜索栏右端，弹出对话框，点同意加载脚本就可以了。还有一个问题，用IE浏览器打开，不会报错，用谷歌浏览器有时候才好，暂时认为是发请求被拒绝了。
## 功能
- 获取50来种音乐类，在页面的footer那里，可以像轮子一样滚动展示，但不是轮播，只是改变容器的left值。
用到了ajax,jQuery,css3。写法是封装了一个footer对象，用了面向对象编程。同时用了发布订阅模式，监听音乐类点击事件，与音乐播放功能分开。
- 音乐播放。
HTML5的Audio对象，这种API还是很实用的，读读文档，上手很快。也是用了jQuery,js的对象封装技术，全封装在app这样一个对象里面了。通过发布订阅模式，监听到自定义事件，立马发送对应的ajax，获取数据，得到数据，渲染DOM。所有的相关方法和事件都封装在app里了。之后，调用就很简单了。
- 自己加了个搜索栏，搜索功能。这里就是用到了JSONP跨域的知识，也是用百度音乐的服务端，因为这个是自己发请求试出来的，百度那边确实回应了数据，但是浏览器默认阻止的，可以点击浏览器的那个提醒，接收就可以收到了。核心就是跨域,还有DOM渲染，以及细节处理比如input框监听事件发送请求需要一个函数节流，事件处理等。这个也是封装在app对象里了。
- 收藏功能。
后来觉得太单调了，想后端数据的奇妙事来着。查了查，知道用localStorage的存储功能存储歌曲的相关数据，可以享受到一点自己也有后端功能的乐趣。相关的数据获取，保存，删除，展示也都封装在app里了。这里的渲染和展示比单单收藏本身还占比大，当时只是为了美和方便，加了一系列的事件。所以，app臃肿了些，但是功能也是增加了。每增加一个功能，不光是实现了它，越细节化，这功能效果越好，但是代码越来越臃肿。
## 立意
初期，只是为了练习jQuery,以及css，还有各种实际实现的效果的。用了新技术，vh和vw，就是面向桌面级的，更多的是面向大屏幕的，屏幕越大，越好。
做的时候，就觉得太简单了，就加点新功能，加了搜索，这个很容易的，加了个js动画，当时不计性能加的，所以会卡，我又舍不得删了，就加了个开关，电脑性能强的就试试吧。又加了收藏，做到了刷新页面，还可以得到以前的东西，当时太对后端着迷了。
加的多了，就臃肿了，就好像物理电路一样，不止是并联还有串联，互相影响，后期维护就很恶心。所以，及其怀念用node和webpack的感觉，直接写成一个个的模块就行了，维护也好维护。这是我去年写的，今年把这个封装的内容改了改。
## 不足
暂时没处理掉为何在谷歌浏览器上经常报错，在IE却运行正常的问题。
前期没想过留有余地给后期扩展做好设想，后期添加其他功能，代码很臃肿，也不好维护。对于这个，我想了想，可以用发布订阅模式的。
自己没事测试的时候，出现两个不好的体验：
- 第一，收藏列表为空的话，去点list图标，没反应，收藏列表没出来，也没提示，比如弹出一个框框说空空如也，快去添加收藏吧，没有，当初立意的时候，就没考虑到这样的情况，体验会不好的，现在修改的话，又觉得影响了现有的构思和性能了，就这样作为一个教训！
- 第二，正在播放收藏的歌的时候，如果在收藏列表删除了的话，突然又想收藏这首歌，收藏不了了，跟我的判断语句有关，当初这样判断只是为了性能，少些步骤。
- 一定要以发展的眼光去看，去布局，去构思，多用事件发布订阅模式，最好一个功能写一个模块，这样维护好维护。
# 地址
[刘万永的音乐主页](https://liuwanyong2017.github.io/musicA/)
源码为此文件夹里的index.html。
# 技术栈
HTML5，ajax,jQuery,css3,面向对象编程，js封装，javaScript。
